<main class="wrap instructions-wrap">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <p>üîÑ Cargando instrucciones...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error">
    <p>‚ùå {{ error }}</p>
    <button class="btn primary" (click)="loadExamenData()">Reintentar</button>
  </div>

  <!-- Success State -->
  <section *ngIf="examen && !isLoading" class="instructions-card">
    <div class="header-row">
      <button class="icon-btn back" aria-label="Volver a evaluaciones" (click)="volver()">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 7l-5 5 5 5V7z"/></svg>
      </button>
      <h1 class="title">Instrucciones: {{ examen.titulo }}</h1>
    </div>

    <div class="content-body">
      <h2>Detalles de la Evaluaci√≥n</h2>
      <ul>
        <li><strong>Materia:</strong> {{ examen.materia }}</li>
        <li><strong>Docente:</strong> {{ examen.docente }}</li>
        <li><strong>Tipo de Evaluaci√≥n:</strong> {{ examen.preguntas_count }} pregunta(s)</li>
        <li><strong>Fecha de Vencimiento:</strong> {{ formatFecha(examen.fecha_limite) }}</li>
        <li><strong>Duraci√≥n estimada:</strong> {{ examen.duracion_minutos }} minutos</li>
      </ul>

      <h2>Reglas Importantes</h2>
      <ol>
        <li class="rule-critical" *ngIf="examen.duracion_minutos">
          <strong>Duraci√≥n:</strong> Tendr√°s un m√°ximo de {{ examen.duracion_minutos }} minutos para completar el examen. El tiempo comienza a correr al hacer clic en "Comenzar Evaluaci√≥n".
        </li>
        <li class="rule-critical" *ngIf="examen.intento_unico">
          <strong>Intento √önico:</strong> Solo tienes un intento para rendir esta evaluaci√≥n. Una vez finalizada, no podr√°s volver a entrar.
        </li>
        <li>
          <strong>Guardado:</strong> Recuerda usar el bot√≥n "Guardar respuesta" despu√©s de cada pregunta de desarrollo. Si cierras la pesta√±a sin guardar, podr√≠as perder tu progreso.
        </li>
        <li>
          <strong>Navegaci√≥n:</strong> Puedes avanzar y retroceder entre preguntas libremente dentro del tiempo asignado.
        </li>
        <li class="rule-critical">
          <strong>Env√≠o Autom√°tico:</strong> Si el tiempo se agota, el examen se enviar√° autom√°ticamente con las respuestas que hayas guardado.
        </li>
      </ol>
      
      <div *ngIf="examen.descripcion && examen.descripcion !== 'Sin descripci√≥n'">
        <h2>Descripci√≥n Adicional</h2>
        <p>{{ examen.descripcion }}</p>
      </div>

      <h2>Requisitos T√©cnicos</h2>
      <ul>
        <li>Aseg√∫rate de tener una conexi√≥n a internet estable.</li>
        <li>Se recomienda usar un navegador actualizado (Chrome, Firefox o Edge).</li>
        <li>No recargues la p√°gina durante el examen para no perder tu progreso.</li>
      </ul>

      <!-- Informaci√≥n espec√≠fica del tipo de preguntas -->
      <div *ngIf="examen.preguntas_count > 0">
        <h2>Tipos de Preguntas</h2>
        <ul>
          <li><strong>Preguntas de desarrollo:</strong> Responde con tus propias palabras.</li>
          <li><strong>Opci√≥n m√∫ltiple:</strong> Selecciona la respuesta correcta.</li>
          <li><strong>Archivos adjuntos:</strong> Puedes subir documentos si se solicita.</li>
        </ul>
      </div>
    </div>
    
    <div class="action-row">
      <button class="btn primary full-width" (click)="startEvaluation()">
        Comenzar Evaluaci√≥n
      </button>
      <button class="btn ghost full-width" (click)="volver()" style="margin-top: 12px;">
        Volver a Evaluaciones
      </button>
    </div>
  </section>
</main>